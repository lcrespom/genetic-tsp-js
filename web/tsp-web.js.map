{"version":3,"sources":["webpack:///webpack/bootstrap 0eeffbb46fdf89e8fbf1","webpack:///./src/tsp-web.ts"],"names":[],"mappings":"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","file":"tsp-web.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 4);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 0eeffbb46fdf89e8fbf1","import { TspSolution, CountryMap } from './tsp'\n\n// ------------------------------ Drawing ------------------------------\n\ntype Point = {\n\tx: number\n\ty: number\n}\n\ntype Cities = Point[]\n\n\nfunction setupContext(): CanvasRenderingContext2D | null {\n\tlet canvas = <HTMLCanvasElement>document.getElementById('canvas')\n\tif (!canvas || !canvas.getContext)\n\t\treturn null\n\tlet ctx = <CanvasRenderingContext2D>canvas.getContext('2d')\n\tctx.clearRect(0, 0, canvas.width, canvas.height)\n\tlet w = canvas.width\n\tcanvas.width = 1\n\tcanvas.width = w\n\treturn ctx\n}\n\nfunction drawCities(ctx: CanvasRenderingContext2D, cities: Cities) {\n\tfor (let i = 0; i < cities.length; i++)\n\t\tctx.fillRect(cities[i].x - 4, cities[i].y - 4, 8, 8)\n}\n\nfunction drawPath(ctx: CanvasRenderingContext2D, cities: Cities, path: number[]) {\n\tlet city\n\tfor (let i = 0; i < path.length; i++) {\n\t\tcity = cities[path[i]]\n\t\tif (i == 0) ctx.moveTo(city.x, city.y)\n\t\telse ctx.lineTo(city.x, city.y)\n\t}\n\tcity = cities[path[0]]\n\tctx.lineTo(city.x, city.y)\n\tctx.stroke()\n}\n\nfunction buildCities(map: CountryMap): Cities {\n\tlet cities: Cities = []\n\tfor (let i = 0; i < map.cityX.length; i++)\n\t\tcities.push({ x: map.cityX[i], y: map.cityY[i] })\n\treturn cities\n}\n\nexport function drawSolution(sol: TspSolution) {\n\tlet cities = buildCities(sol.map)\n\tif (cities.length == 0) return\n\tlet ctx = setupContext()\n\tif (!ctx) return\n\tctx.fillStyle = '#00f'\n\tctx.strokeStyle = '#000'\n\tctx.lineWidth = 2\n\tdrawPath(ctx, cities, sol.cities)\n\tdrawCities(ctx, cities)\n}\n\n\n// ------------------------------ Statistics ------------------------------\n\nfunction formatNum(nStr) {\n\tnStr += ''\n\tlet rgx = /(\\d+)(\\d{3})/\n\twhile (rgx.test(nStr))\n\t\tnStr = nStr.replace(rgx, '$1.$2')\n\treturn nStr\n}\n\nfunction prepend0(num) {\n\tif (num < 10) return '0' + num\n\treturn num\n}\n\nfunction formatTime(t: number) {\n\tlet h, m, s\n\ts = Math.round(t / 1000)\n\tm = Math.floor(s / 60)\n\th = Math.floor(m / 60)\n\treturn '' + h + ':' + prepend0(m % 60) + ':' + prepend0(s % 60)\n}\n\nfunction updateStatistics(status) {\n\tsetText('status.generation', formatNum(status.generation))\n\tsetText('status.gpm', formatNum(status.gpm.toFixed(0)))\n\tsetText('status.eval', formatNum(Math.round(status.eval)))\n\tsetText('status.lastIncumbentGen', formatNum(status.lastIncumbentGen))\n\tsetText('status.elapsed', formatTime(status.elapsed))\n\tsetText('status.lastIncumbentWhen', formatTime(status.lastIncumbentWhen))\n}\n\n\n// ------------------------------ Event handling ------------------------------\n\nlet but = byId('start') || new HTMLElement()\nbut.addEventListener('click', evt => {\n\tlet worker = new Worker('tsp-worker.js')\n\tworker.postMessage({ command: 'start', params: {}})\n\tworker.onmessage = msg => {\n\t\tupdateStatistics(msg.data)\n\t\tif (msg.data.incumbent)\n\t\t\tdrawSolution(msg.data.incumbent)\n\t}\n\tbut.hidden = true\n})\n\n\n// ------------------------------ Utilities ------------------------------\n\nfunction byId(id: string): HTMLElement | null {\n\treturn document.getElementById(id)\n}\n\nfunction setText(id: string, txt: string) {\n\tlet elem = byId(id)\n\tif (!elem) return\n\tif (elem.tagName == 'INPUT')\n\t\t(<HTMLInputElement>elem).value = txt\n\telse\n\t\telem.innerText = txt\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/tsp-web.ts"],"sourceRoot":""}